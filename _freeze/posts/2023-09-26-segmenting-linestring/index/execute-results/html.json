{
  "hash": "ff9d607e54324ca9842e3c8b9404c37e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Segmenting linestring into points of equal distance'\nauthor: 'Philippe Massicotte'\ndate: '2023-09-26'\ncategories: [R, sf, geospatial, rspatial]\n# The preview file needs to be named preview.png\n# mogrify -format png preview.jpg\n# https://quarto.org/docs/websites/website-tools.html#preview-images\nimage: 'img/preview.png'\neditor_options:\n  chunk_output_type: console\ncitation: true\n---\n\n\n\n\n\n\nThis will be a quick one, but I thought it was worth sharing (at least for future me). I was recently trying to segment a line into points of equal distances. I must say that I spent too much time with the `st_segmentize()` function. I found that I would simply achieve this using `st_line_sample()`. Let me show you how.\n\n![When your brain is super well synchronized with your camera’s retadator.](img/preview.png){width=85%}\n\n<center>Photo by <a href=\"https://unsplash.com/@arizonanthony?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">Anthony Cantin</a> on <a href=\"https://unsplash.com/photos/HtM6I5_jR6o?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">Unsplash</a></center>\n\nFirst, I will read a KML file containing the path of the [CCGS Amundsen](https://amundsenscience.com/). I will then transform the data into a polar projection.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nsf_use_s2(TRUE)\n\npath <- st_read(\"https://data.amundsen.ulaval.ca/NAV_Amundsen.kml\") |>\n  st_transform(3413)\n#> Reading layer `\n#> D:\\Remote_data\\NAV_Amundsen.kml\n#> ' from data source \n#>   `https://data.amundsen.ulaval.ca/NAV_Amundsen.kml' using driver `LIBKML'\n#> Simple feature collection with 1 feature and 11 fields\n#> Geometry type: LINESTRING\n#> Dimension:     XYZ\n#> Bounding box:  xmin: 6.59 ymin: -71.20211 xmax: 7.97 ymax: -71.2021\n#> z_range:       zmin: 1 zmax: 1\n#> Geodetic CRS:  WGS 84\n\n# We can see that the path is a linestring\npath\n#> Simple feature collection with 1 feature and 11 fields\n#> Geometry type: LINESTRING\n#> Dimension:     XYZ\n#> Bounding box:  xmin: 58000050 ymin: -45986760 xmax: 59090720 ymax: -44576580\n#> z_range:       zmin: 1 zmax: 1\n#> Projected CRS: WGS 84 / NSIDC Sea Ice Polar Stereographic North\n#>          Name description timestamp begin  end  altitudeMode tessellate extrude\n#> 1 \\nge_plot\\n        \\n\\n      <NA>  <NA> <NA> clampToGround          1       0\n#>   visibility drawOrder icon                       geometry\n#> 1          1        NA <NA> LINESTRING Z (58391203 -454...\n\nst_length(path)\n#> 14029682 [m]\n```\n:::\n\n\nJust for fun, let's visualize it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npath |>\n  ggplot() +\n  geom_sf()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png)\n:::\n:::\n\n\nNow is the fun part I discovered. You can use the `density` argument of the `st_line_sample()` function to convert a LINESTRING into points of equal distances, let's say 50 kilometres. Note that the new geometry is MULTIPOINT.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npts <- st_line_sample(path, density = units::as_units(50, \"km\"))\n\npts\n#> Geometry set for 1 feature \n#> Geometry type: MULTIPOINT\n#> Dimension:     XYZ\n#> Bounding box:  xmin: 58006120 ymin: -45978910 xmax: 59090720 ymax: -44576580\n#> z_range:       zmin: 1 zmax: 1\n#> Projected CRS: WGS 84 / NSIDC Sea Ice Polar Stereographic North\n\npts |>\n  ggplot() +\n  geom_sf()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png)\n:::\n:::\n\n\nWe can verify that we have roughly 50 km between each point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npts |>\n  st_cast(\"POINT\") |>\n  st_as_sf() |>\n  mutate(dist = st_distance(x, lag(x), by_element = TRUE))\n#> Simple feature collection with 281 features and 1 field\n#> Geometry type: POINT\n#> Dimension:     XYZ\n#> Bounding box:  xmin: 58006120 ymin: -45978910 xmax: 59090720 ymax: -44576580\n#> Projected CRS: WGS 84 / NSIDC Sea Ice Polar Stereographic North\n#> First 10 features:\n#>                                 x         dist\n#> 1  POINT Z (58406541 -45469359 1)       NA [m]\n#> 2  POINT Z (58437199 -45429958 1) 49923.68 [m]\n#> 3  POINT Z (58425633 -45444830 1) 18840.63 [m]\n#> 4  POINT Z (58394962 -45484226 1) 49927.69 [m]\n#> 5  POINT Z (58364268 -45523604 1) 49927.69 [m]\n#> 6  POINT Z (58333544 -45562959 1) 49927.66 [m]\n#> 7  POINT Z (58302758 -45602266 1) 49927.69 [m]\n#> 8  POINT Z (58271973 -45641573 1) 49927.69 [m]\n#> 9  POINT Z (58241188 -45680880 1) 49927.69 [m]\n#> 10 POINT Z (58210402 -45720187 1) 49927.69 [m]\n```\n:::\n\n\n<details>\n  \n<summary>Session info</summary>\n\n\n::: {.cell}\n\n```\n#> ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────\n#>  setting  value\n#>  version  R version 4.4.0 (2024-04-24)\n#>  os       Linux Mint 21.3\n#>  system   x86_64, linux-gnu\n#>  ui       X11\n#>  language en_CA:en\n#>  collate  en_CA.UTF-8\n#>  ctype    en_CA.UTF-8\n#>  tz       America/Montreal\n#>  date     2024-05-03\n#>  pandoc   2.9.2.1 @ /usr/bin/ (via rmarkdown)\n#> \n#> ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────\n#>  ! package     * version date (UTC) lib source\n#>  P cachem        1.0.8   2023-05-01 [?] RSPM\n#>  P class         7.3-22  2023-05-03 [?] CRAN (R 4.3.1)\n#>  P classInt      0.4-10  2023-09-05 [?] RSPM\n#>  P cli           3.6.2   2023-12-11 [?] RSPM\n#>  P colorspace    2.1-0   2023-01-23 [?] RSPM\n#>  P DBI           1.2.2   2024-02-16 [?] RSPM\n#>  P devtools      2.4.5   2022-10-11 [?] RSPM (R 4.4.0)\n#>  P digest        0.6.35  2024-03-11 [?] RSPM\n#>  P dplyr       * 1.1.4   2023-11-17 [?] RSPM\n#>  P e1071         1.7-14  2023-12-06 [?] RSPM\n#>  P ellipsis      0.3.2   2021-04-29 [?] RSPM\n#>  P evaluate      0.23    2023-11-01 [?] RSPM\n#>  P extrafont     0.19    2023-01-18 [?] RSPM\n#>  P extrafontdb   1.0     2012-06-11 [?] RSPM\n#>  P fansi         1.0.6   2023-12-08 [?] RSPM\n#>  P farver        2.1.1   2022-07-06 [?] RSPM\n#>  P fastmap       1.1.1   2023-02-24 [?] RSPM\n#>  P forcats     * 1.0.0   2023-01-29 [?] RSPM\n#>  P fs            1.6.4   2024-04-25 [?] CRAN (R 4.4.0)\n#>  P generics      0.1.3   2022-07-05 [?] RSPM\n#>  P ggplot2     * 3.5.1   2024-04-23 [?] RSPM\n#>  P ggpmthemes  * 0.0.2   2024-04-25 [?] Github (pmassicotte/ggpmthemes@993d61e)\n#>  P glue          1.7.0   2024-01-09 [?] RSPM\n#>  P gtable        0.3.5   2024-04-22 [?] RSPM\n#>  P hms           1.1.3   2023-03-21 [?] RSPM\n#>  P htmltools     0.5.8.1 2024-04-04 [?] RSPM\n#>  P htmlwidgets   1.6.4   2023-12-06 [?] RSPM\n#>  P httpuv        1.6.15  2024-03-26 [?] RSPM\n#>  P jsonlite      1.8.8   2023-12-04 [?] RSPM\n#>  P KernSmooth    2.23-22 2023-07-10 [?] CRAN (R 4.3.1)\n#>  P knitr         1.46    2024-04-06 [?] RSPM\n#>  P later         1.3.2   2023-12-06 [?] RSPM\n#>  P lifecycle     1.0.4   2023-11-07 [?] RSPM\n#>  P lubridate   * 1.9.3   2023-09-27 [?] RSPM\n#>  P magrittr      2.0.3   2022-03-30 [?] RSPM\n#>  P memoise       2.0.1   2021-11-26 [?] RSPM\n#>  P mime          0.12    2021-09-28 [?] RSPM\n#>  P miniUI        0.1.1.1 2018-05-18 [?] RSPM (R 4.4.0)\n#>  P munsell       0.5.1   2024-04-01 [?] RSPM\n#>  P pillar        1.9.0   2023-03-22 [?] RSPM\n#>  P pkgbuild      1.4.4   2024-03-17 [?] RSPM (R 4.4.0)\n#>  P pkgconfig     2.0.3   2019-09-22 [?] RSPM\n#>  P pkgload       1.3.4   2024-01-16 [?] RSPM (R 4.4.0)\n#>  P processx      3.8.4   2024-03-16 [?] RSPM\n#>  P profvis       0.3.8   2023-05-02 [?] RSPM (R 4.4.0)\n#>  P promises      1.3.0   2024-04-05 [?] RSPM\n#>  P proxy         0.4-27  2022-06-09 [?] RSPM\n#>  P ps            1.7.6   2024-01-18 [?] RSPM\n#>  P purrr       * 1.0.2   2023-08-10 [?] RSPM\n#>  P quarto      * 1.4     2024-03-06 [?] RSPM\n#>  P R.cache       0.16.0  2022-07-21 [?] RSPM\n#>  P R.methodsS3   1.8.2   2022-06-13 [?] RSPM\n#>  P R.oo          1.26.0  2024-01-24 [?] RSPM\n#>  P R.utils       2.12.3  2023-11-18 [?] RSPM\n#>  P R6            2.5.1   2021-08-19 [?] RSPM\n#>  P Rcpp          1.0.12  2024-01-09 [?] RSPM\n#>  P readr       * 2.1.5   2024-01-10 [?] RSPM\n#>  P remotes       2.5.0   2024-03-17 [?] RSPM (R 4.4.0)\n#>  P renv          1.0.7   2024-04-11 [?] RSPM (R 4.4.0)\n#>  P rlang         1.1.3   2024-01-10 [?] RSPM\n#>  P rmarkdown     2.26    2024-03-05 [?] RSPM\n#>  P rstudioapi    0.16.0  2024-03-24 [?] RSPM\n#>  P Rttf2pt1      1.3.12  2023-01-22 [?] RSPM\n#>  P scales        1.3.0   2023-11-28 [?] RSPM\n#>  P sessioninfo   1.2.2   2021-12-06 [?] RSPM (R 4.4.0)\n#>  P sf          * 1.0-16  2024-03-24 [?] RSPM\n#>  P shiny         1.8.1.1 2024-04-02 [?] RSPM (R 4.4.0)\n#>  P stringi       1.8.3   2023-12-11 [?] RSPM\n#>  P stringr     * 1.5.1   2023-11-14 [?] RSPM\n#>  P styler      * 1.10.3  2024-04-07 [?] RSPM\n#>  P tibble      * 3.2.1   2023-03-20 [?] RSPM\n#>  P tidyr       * 1.3.1   2024-01-24 [?] RSPM\n#>  P tidyselect    1.2.1   2024-03-11 [?] RSPM\n#>  P tidyverse   * 2.0.0   2023-02-22 [?] RSPM\n#>  P timechange    0.3.0   2024-01-18 [?] RSPM\n#>  P tzdb          0.4.0   2023-05-12 [?] RSPM\n#>  P units         0.8-5   2023-11-28 [?] RSPM\n#>  P urlchecker    1.0.1   2021-11-30 [?] RSPM (R 4.4.0)\n#>  P usethis       2.2.3   2024-02-19 [?] RSPM (R 4.4.0)\n#>  P utf8          1.2.4   2023-10-22 [?] RSPM\n#>  P vctrs         0.6.5   2023-12-01 [?] RSPM\n#>  P withr         3.0.0   2024-01-16 [?] RSPM\n#>  P xfun          0.43    2024-03-25 [?] RSPM\n#>  P xtable        1.8-4   2019-04-21 [?] RSPM (R 4.4.0)\n#>  P yaml          2.3.8   2023-12-11 [?] RSPM\n#> \n#>  [1] /tmp/RtmpvEsv6t/renv-use-libpath-25a135303bd529\n#>  [2] /tmp/RtmpvEsv6t/renv-sandbox\n#> \n#>  P ── Loaded and on-disk path mismatch.\n#> \n#> ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────\n```\n:::\n\n\n</details>\n\n<details>\n\n<summary>renv.lock file</summary>\n\n```{.json include=\"renv.lock\"}\n\n```\n\n</details>\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}