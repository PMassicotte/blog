{
  "hash": "3e74432cab30c49e82cc339b5ac0b5bc",
  "result": {
    "markdown": "---\ntitle: \"Choosing the right geographic projection with the crsuggest R package\"\nauthor: \"Philippe Massicotte\"\ndate: \"2021-11-12\"\ncategories: [R, Geospatial]\ntwitter-card:\n  image: \"img/preview.jpg\"\n---\n\n\n\n\nWhen creating maps, choosing an appropriate geographical projection is often a difficult task (at least for me). [There are plenty of projections to choose from](https://www.geo-projections.com/), and [none can be qualified as the best one](https://www.axismaps.com/guide/map-projections). It all depends on what you are trying to achieve. Websites like [the projection wizard website](https://projectionwizard.org/) offer a playground to experiment with different projections and how they look like depending on where you are looking at on the globe.\n\n![A medieval depiction of the Ecumene (1482, Johannes Schnitzer, engraver), constructed after the coordinates in Ptolemy's Geography and using his second map projection](img/preview.jpg)\n\n<small>Image from: https://en.wikipedia.org/wiki/Map_projection</small>\n\nThe goal of this blog post is not to go into details and consideration on how to choose *a good* projection (it is out of my expertise), but rather present a quick overview of the `crsuggest` [R package](https://github.com/walkerke/crsuggest) that can help to find a projection suited for the data to be displayed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\nlibrary(sf)\nlibrary(patchwork)\n\nlibrary(crsuggest)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Download the Greenland shapefile\nmap <- ne_countries(country = \"greenland\", returnclass = \"sf\", scale = \"medium\")\n\n# Looks at the projection\nst_crs(map)$proj4string\n#> [1] \"+proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs\"\n```\n:::\n\n\nWe can see that WGS84 is used as the reference coordinate system. Plotting the shapefile immediately shows that the result is somewhat distorted.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot() +\n  geom_sf(data = map)\n\np1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png)\n:::\n:::\n\n\nTime to look at the `crsuggest` package. The function `suggest_crs()` takes a spatial dataset as inputs (here the `map` object) and return a list (*n = 10* by default) of suggested coordinate systems in a [tibble](https://tibble.tidyverse.org/).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuggested_crs <- suggest_crs(map, limit = 3)\nsuggested_crs\n#> # A tibble: 3 × 6\n#>   crs_code crs_name                              crs_t…¹ crs_gcs crs_u…² crs_p…³\n#>   <chr>    <chr>                                 <chr>     <dbl> <chr>   <chr>  \n#> 1 5922     WGS 84 / EPSG Arctic Regional zone A2 projec…    4326 m       +proj=…\n#> 2 6054     GR96 / EPSG Arctic zone 3-31          projec…    4747 m       +proj=…\n#> 3 6051     GR96 / EPSG Arctic zone 2-18          projec…    4747 m       +proj=…\n#> # … with abbreviated variable names ¹​crs_type, ²​crs_units, ³​crs_proj4\n```\n:::\n\n\nLet's make some plots using the suggested CRS.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_map <- function(crs, map) {\n  ggplot() +\n    geom_sf(data = map) +\n    coord_sf(crs = as.numeric(crs)) +\n    labs(\n      title = paste(\"CRS:\", crs)\n    )\n}\n\nmaps <- lapply(suggested_crs$crs_code, plot_map, map = map)\n```\n:::\n\n\nWe can see that the projected maps look more accurate than the original map.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrap_plots(maps, ncol = 3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png)\n:::\n:::\n\n\nThis is even more obvious when they are compared side by side.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot() +\n  geom_sf(data = map) +\n  coord_sf(crs = 5922)\n\np1 + p2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/compare_crs-1.png)\n:::\n:::\n\n\n<details>\n  \n<summary>Session info</summary>\n\n\n::: {.cell}\n\n```\n#> ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────\n#>  setting  value\n#>  version  R version 4.2.1 (2022-06-23)\n#>  os       Linux Mint 21\n#>  system   x86_64, linux-gnu\n#>  ui       X11\n#>  language en_CA:en\n#>  collate  en_CA.UTF-8\n#>  ctype    en_CA.UTF-8\n#>  tz       America/Montreal\n#>  date     2022-08-10\n#>  pandoc   2.18 @ /usr/lib/rstudio/bin/quarto/bin/tools/ (via rmarkdown)\n#> \n#> ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────\n#>  ! package           * version date (UTC) lib source\n#>  P assertthat          0.2.1   2019-03-21 [?] RSPM\n#>  P backports           1.4.1   2021-12-13 [?] RSPM\n#>  P base64enc           0.1-3   2015-07-28 [?] RSPM\n#>  P broom               1.0.0   2022-07-01 [?] RSPM (R 4.2.1)\n#>  P cachem              1.0.6   2021-08-19 [?] RSPM (R 4.2.0)\n#>  P callr               3.7.1   2022-07-13 [?] RSPM (R 4.2.1)\n#>  P cellranger          1.1.0   2016-07-27 [?] RSPM\n#>  P class               7.3-20  2022-01-13 [?] RSPM (R 4.2.0)\n#>  P classInt            0.4-7   2022-06-10 [?] RSPM (R 4.2.0)\n#>  P cli                 3.3.0   2022-04-25 [?] RSPM (R 4.2.0)\n#>    codetools           0.2-18  2020-11-04 [2] CRAN (R 4.2.1)\n#>  P colorspace          2.0-3   2022-02-21 [?] RSPM (R 4.2.0)\n#>  P crayon              1.5.1   2022-03-26 [?] RSPM (R 4.2.0)\n#>  P crosstalk           1.2.0   2021-11-04 [?] RSPM (R 4.2.0)\n#>  P crsuggest         * 0.4     2022-07-06 [?] RSPM (R 4.2.0)\n#>  P DBI                 1.1.3   2022-06-18 [?] RSPM (R 4.2.0)\n#>  P dbplyr              2.2.1   2022-06-27 [?] RSPM (R 4.2.0)\n#>  P devtools            2.4.4   2022-07-20 [?] RSPM (R 4.2.0)\n#>  P digest              0.6.29  2021-12-01 [?] RSPM\n#>  P dplyr             * 1.0.9   2022-04-28 [?] RSPM (R 4.2.0)\n#>  P e1071               1.7-11  2022-06-07 [?] RSPM (R 4.2.0)\n#>  P ellipsis            0.3.2   2021-04-29 [?] RSPM\n#>  P evaluate            0.15    2022-02-18 [?] RSPM (R 4.2.0)\n#>  P extrafont           0.18    2022-04-12 [?] RSPM (R 4.2.0)\n#>  P extrafontdb         1.0     2012-06-11 [?] RSPM (R 4.2.0)\n#>  P fansi               1.0.3   2022-03-24 [?] RSPM (R 4.2.0)\n#>  P farver              2.1.1   2022-07-06 [?] RSPM (R 4.2.1)\n#>  P fastmap             1.1.0   2021-01-25 [?] RSPM\n#>  P forcats           * 0.5.1   2021-01-27 [?] RSPM\n#>  P fs                  1.5.2   2021-12-08 [?] RSPM\n#>  P gargle              1.2.0   2021-07-02 [?] RSPM\n#>  P generics            0.1.3   2022-07-05 [?] RSPM (R 4.2.1)\n#>  P ggplot2           * 3.3.6   2022-05-03 [?] RSPM (R 4.2.0)\n#>  P ggpmthemes        * 0.0.2   2022-08-08 [?] Github (pmassicotte/ggpmthemes@993d61e)\n#>  P glue                1.6.2   2022-02-24 [?] RSPM (R 4.2.0)\n#>  P googledrive         2.0.0   2021-07-08 [?] RSPM\n#>  P googlesheets4       1.0.0   2021-07-21 [?] RSPM\n#>  P gtable              0.3.0   2019-03-25 [?] RSPM\n#>  P haven               2.5.0   2022-04-15 [?] RSPM (R 4.2.0)\n#>  P hms                 1.1.1   2021-09-26 [?] RSPM\n#>  P htmltools           0.5.3   2022-07-18 [?] RSPM (R 4.2.1)\n#>  P htmlwidgets         1.5.4   2021-09-08 [?] RSPM (R 4.2.0)\n#>  P httpuv              1.6.5   2022-01-05 [?] RSPM (R 4.2.0)\n#>  P httr                1.4.3   2022-05-04 [?] RSPM (R 4.2.0)\n#>  P jsonlite            1.8.0   2022-02-22 [?] RSPM (R 4.2.0)\n#>  P KernSmooth          2.23-20 2021-05-03 [?] RSPM (R 4.2.0)\n#>  P knitr               1.39    2022-04-26 [?] RSPM (R 4.2.0)\n#>  P later               1.3.0   2021-08-18 [?] RSPM (R 4.2.0)\n#>  P lattice             0.20-45 2021-09-22 [?] RSPM (R 4.2.0)\n#>  P leafem              0.2.0   2022-04-16 [?] CRAN (R 4.2.0)\n#>  P leaflet             2.1.1   2022-03-23 [?] RSPM (R 4.2.0)\n#>  P lifecycle           1.0.1   2021-09-24 [?] RSPM\n#>  P lubridate           1.8.0   2021-10-07 [?] RSPM\n#>  P magrittr            2.0.3   2022-03-30 [?] RSPM (R 4.2.0)\n#>  P mapview             2.11.0  2022-04-16 [?] CRAN (R 4.2.0)\n#>  P memoise             2.0.1   2021-11-26 [?] CRAN (R 4.2.0)\n#>  P mime                0.12    2021-09-28 [?] RSPM\n#>  P miniUI              0.1.1.1 2018-05-18 [?] RSPM (R 4.2.0)\n#>  P modelr              0.1.8   2020-05-19 [?] RSPM\n#>  P munsell             0.5.0   2018-06-12 [?] RSPM\n#>  P patchwork         * 1.1.1   2020-12-17 [?] RSPM\n#>  P pillar              1.8.0   2022-07-18 [?] RSPM (R 4.2.1)\n#>  P pkgbuild            1.3.1   2021-12-20 [?] CRAN (R 4.2.0)\n#>  P pkgconfig           2.0.3   2019-09-22 [?] RSPM\n#>  P pkgload             1.3.0   2022-06-27 [?] RSPM (R 4.2.0)\n#>  P png                 0.1-7   2013-12-03 [?] RSPM (R 4.2.0)\n#>  P prettyunits         1.1.1   2020-01-24 [?] RSPM\n#>  P processx            3.7.0   2022-07-07 [?] RSPM (R 4.2.1)\n#>  P profvis             0.3.7   2020-11-02 [?] RSPM (R 4.2.0)\n#>  P promises            1.2.0.1 2021-02-11 [?] RSPM (R 4.2.0)\n#>  P proxy               0.4-27  2022-06-09 [?] RSPM (R 4.2.0)\n#>  P ps                  1.7.1   2022-06-18 [?] RSPM (R 4.2.0)\n#>  P purrr             * 0.3.4   2020-04-17 [?] RSPM\n#>  P R6                  2.5.1   2021-08-19 [?] RSPM\n#>  P raster              3.5-21  2022-06-27 [?] RSPM (R 4.2.0)\n#>  P Rcpp                1.0.9   2022-07-08 [?] RSPM (R 4.2.1)\n#>  P readr             * 2.1.2   2022-01-30 [?] RSPM (R 4.2.0)\n#>  P readxl              1.4.0   2022-03-28 [?] RSPM (R 4.2.0)\n#>  P remotes             2.4.2   2021-11-30 [?] CRAN (R 4.2.0)\n#>    renv                0.15.5  2022-05-26 [1] RSPM (R 4.2.0)\n#>  P reprex              2.0.1   2021-08-05 [?] RSPM\n#>  P rlang               1.0.4   2022-07-12 [?] RSPM (R 4.2.1)\n#>  P rmarkdown           2.14    2022-04-25 [?] RSPM (R 4.2.0)\n#>  P rnaturalearth     * 0.1.0   2017-03-21 [?] RSPM (R 4.2.0)\n#>  P rnaturalearthdata   0.1.0   2017-02-21 [?] RSPM (R 4.2.0)\n#>  P rstudioapi          0.13    2020-11-12 [?] RSPM\n#>  P Rttf2pt1            1.3.10  2022-02-07 [?] RSPM (R 4.2.0)\n#>  P rvest               1.0.2   2021-10-16 [?] RSPM\n#>  P s2                  1.1.0   2022-07-18 [?] RSPM (R 4.2.0)\n#>  P satellite           1.0.4   2021-10-12 [?] CRAN (R 4.2.0)\n#>  P scales              1.2.0   2022-04-13 [?] RSPM (R 4.2.0)\n#>  P sessioninfo         1.2.2   2021-12-06 [?] CRAN (R 4.2.0)\n#>  P sf                * 1.0-8   2022-07-14 [?] RSPM (R 4.2.0)\n#>  P shiny               1.7.2   2022-07-19 [?] RSPM (R 4.2.1)\n#>  P sp                  1.5-0   2022-06-05 [?] RSPM (R 4.2.0)\n#>  P stringi             1.7.8   2022-07-11 [?] RSPM (R 4.2.1)\n#>  P stringr           * 1.4.0   2019-02-10 [?] RSPM\n#>  P terra               1.6-3   2022-07-25 [?] RSPM (R 4.2.0)\n#>  P tibble            * 3.1.8   2022-07-22 [?] RSPM (R 4.2.1)\n#>  P tidyr             * 1.2.0   2022-02-01 [?] RSPM (R 4.2.0)\n#>  P tidyselect          1.1.2   2022-02-21 [?] RSPM (R 4.2.0)\n#>  P tidyverse         * 1.3.2   2022-07-18 [?] RSPM (R 4.2.0)\n#>  P tzdb                0.3.0   2022-03-28 [?] RSPM (R 4.2.0)\n#>  P units               0.8-0   2022-02-05 [?] RSPM (R 4.2.0)\n#>  P urlchecker          1.0.1   2021-11-30 [?] RSPM (R 4.2.0)\n#>  P usethis             2.1.6   2022-05-25 [?] RSPM (R 4.2.0)\n#>  P utf8                1.2.2   2021-07-24 [?] RSPM\n#>  P vctrs               0.4.1   2022-04-13 [?] RSPM (R 4.2.0)\n#>  P webshot             0.5.3   2022-04-14 [?] CRAN (R 4.2.0)\n#>  P withr               2.5.0   2022-03-03 [?] RSPM (R 4.2.0)\n#>  P wk                  0.6.0   2022-01-03 [?] RSPM (R 4.2.0)\n#>  P xfun                0.31    2022-05-10 [?] RSPM (R 4.2.0)\n#>  P xml2                1.3.3   2021-11-30 [?] RSPM\n#>  P xtable              1.8-4   2019-04-21 [?] RSPM (R 4.2.0)\n#>  P yaml                2.3.5   2022-02-21 [?] RSPM (R 4.2.0)\n#> \n#>  [1] /media/LaCie16TB/work/r-blog/renv/library/R-4.2/x86_64-pc-linux-gnu\n#>  [2] /usr/local/lib/R/library\n#> \n#>  P ── Loaded and on-disk path mismatch.\n#> \n#> ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────\n```\n:::\n\n\n</details>\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}