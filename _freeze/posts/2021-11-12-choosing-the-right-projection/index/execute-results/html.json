{
  "hash": "cd5f806027218d484a906d2b16f8b43a",
  "result": {
    "markdown": "---\ntitle: \"Choosing the right geographic projection with the crsuggest R package\"\nauthor: \"Philippe Massicotte\"\ndate: \"2021-11-12\"\ncategories: [R, geospatial]\nimage: \"world.jpg\"\n---\n\n\n\n\nWhen creating maps, choosing an appropriate geographical projection is often a difficult task (at least for me). [There are plenty of projections to choose from](https://www.geo-projections.com/), and [none can be qualified as the best one](https://www.axismaps.com/guide/map-projections). It all depends on what you are trying to achieve. Websites like [the projection wizard website](https://projectionwizard.org/) offer a playground to experiment with different projections and how they look like depending on where you are looking at on the globe.\n\n![A medieval depiction of the Ecumene (1482, Johannes Schnitzer, engraver), constructed after the coordinates in Ptolemy's Geography and using his second map projection](world.jpg)\n\n<small>Image from: https://en.wikipedia.org/wiki/Map_projection</small>\n\nThe goal of this blog post is not to go into details and consideration on how to choose *a good* projection (it is out of my expertise), but rather present a quick overview of the `crsuggest` [R package](https://github.com/walkerke/crsuggest) that can help to find a projection suited for the data to be displayed.\n\n\n::: {.cell layout-align=\"center\" hash='index_cache/html/unnamed-chunk-1_be7a3f9184503893f94598b8bd02d0a0'}\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\nlibrary(sf)\nlibrary(patchwork)\n\nlibrary(crsuggest)\n```\n:::\n\n::: {.cell layout-align=\"center\" hash='index_cache/html/unnamed-chunk-2_b3f6e48e7af33e31969923392bfec126'}\n\n```{.r .cell-code}\n# Download the Greenland shapefile\nmap <- ne_countries(country = \"greenland\", returnclass = \"sf\", scale = \"medium\")\n\n# Looks at the projection\nst_crs(map)$proj4string\n#> [1] \"+proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs\"\n```\n:::\n\n\nWe can see that WGS84 is used as the reference coordinate system. Plotting the shapefile immediately shows that the result is somewhat distorted.\n\n\n::: {.cell layout-align=\"center\" hash='index_cache/html/unnamed-chunk-3_19b343e448d839be19fb83d1358e9463'}\n\n```{.r .cell-code}\np1 <- ggplot() +\n  geom_sf(data = map)\n\np1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nTime to look at the `crsuggest` package. The function `suggest_crs()` takes a spatial dataset as inputs (here the `map` object) and return a list (*n = 10* by default) of suggested coordinate systems in a [tibble](https://tibble.tidyverse.org/).\n\n\n::: {.cell layout-align=\"center\" hash='index_cache/html/unnamed-chunk-4_5c05f7168eef2ba83d8e92acfc4d326c'}\n\n```{.r .cell-code}\nsuggested_crs <- suggest_crs(map, limit = 3)\nsuggested_crs\n#> # A tibble: 3 × 6\n#>   crs_code crs_name                              crs_t…¹ crs_gcs crs_u…² crs_p…³\n#>   <chr>    <chr>                                 <chr>     <dbl> <chr>   <chr>  \n#> 1 5922     WGS 84 / EPSG Arctic Regional zone A2 projec…    4326 m       +proj=…\n#> 2 6054     GR96 / EPSG Arctic zone 3-31          projec…    4747 m       +proj=…\n#> 3 6051     GR96 / EPSG Arctic zone 2-18          projec…    4747 m       +proj=…\n#> # … with abbreviated variable names ¹​crs_type, ²​crs_units, ³​crs_proj4\n```\n:::\n\n\nLet's make some plots using the suggested CRS.\n\n\n::: {.cell layout-align=\"center\" hash='index_cache/html/unnamed-chunk-5_85b462b36e1d1a130d7f79f1d561f0dd'}\n\n```{.r .cell-code}\nplot_map <- function(crs, map) {\n  ggplot() +\n    geom_sf(data = map) +\n    coord_sf(crs = as.numeric(crs)) +\n    labs(\n      title = paste(\"CRS:\", crs)\n    )\n}\n\nmaps <- lapply(suggested_crs$crs_code, plot_map, map = map)\n```\n:::\n\n\nWe can see that the projected maps look more accurate than the original map.\n\n\n::: {.cell layout-align=\"center\" hash='index_cache/html/unnamed-chunk-6_da811e26173073438b6bea8582ff97ac'}\n\n```{.r .cell-code}\nwrap_plots(maps, ncol = 3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nThis is even more obvious when they are compared side by side.\n\n\n::: {.cell layout-align=\"center\" hash='index_cache/html/compare_crs_b538fdcfc78e514db449b73d8e204166'}\n\n```{.r .cell-code}\np2 <- ggplot() +\n  geom_sf(data = map) +\n  coord_sf(crs = 5922)\n\np1 + p2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/compare_crs-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n<details>\n  \n<summary>Session info</summary>\n\n\n::: {.cell layout-align=\"center\" hash='index_cache/html/sessioninfo_507929d96331e7e94eeb3bad9a7b84e2'}\n\n```\n#> ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────\n#>  setting  value\n#>  version  R version 4.2.1 (2022-06-23)\n#>  os       Ubuntu 22.04 LTS\n#>  system   x86_64, linux-gnu\n#>  ui       X11\n#>  language en_CA:en\n#>  collate  en_CA.UTF-8\n#>  ctype    en_CA.UTF-8\n#>  tz       America/Toronto\n#>  date     2022-07-30\n#>  pandoc   2.18 @ /usr/lib/rstudio/bin/quarto/bin/tools/ (via rmarkdown)\n#> \n#> ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────\n#>  package           * version date (UTC) lib source\n#>  assertthat          0.2.1   2019-03-21 [1] RSPM (R 4.2.0)\n#>  backports           1.4.1   2021-12-13 [1] RSPM (R 4.2.0)\n#>  base64enc           0.1-3   2015-07-28 [1] RSPM (R 4.2.0)\n#>  broom               1.0.0   2022-07-01 [1] RSPM (R 4.2.0)\n#>  cachem              1.0.6   2021-08-19 [1] RSPM (R 4.2.0)\n#>  callr               3.7.1   2022-07-13 [1] RSPM (R 4.2.0)\n#>  cellranger          1.1.0   2016-07-27 [1] RSPM (R 4.2.0)\n#>  class               7.3-20  2022-01-16 [2] CRAN (R 4.2.1)\n#>  classInt            0.4-7   2022-06-10 [1] CRAN (R 4.2.1)\n#>  cli                 3.3.0   2022-04-25 [1] RSPM (R 4.2.0)\n#>  codetools           0.2-18  2020-11-04 [2] CRAN (R 4.2.1)\n#>  colorspace          2.0-3   2022-02-21 [1] RSPM (R 4.2.0)\n#>  crayon              1.5.1   2022-03-26 [1] RSPM (R 4.2.0)\n#>  crosstalk           1.2.0   2021-11-04 [1] RSPM (R 4.2.0)\n#>  crsuggest         * 0.4     2022-07-06 [1] RSPM (R 4.2.0)\n#>  DBI                 1.1.3   2022-06-18 [1] RSPM (R 4.2.0)\n#>  dbplyr              2.2.1   2022-06-27 [1] RSPM (R 4.2.0)\n#>  devtools            2.4.4   2022-07-20 [1] RSPM (R 4.2.0)\n#>  digest              0.6.29  2021-12-01 [1] RSPM (R 4.2.0)\n#>  dplyr             * 1.0.9   2022-04-28 [1] RSPM (R 4.2.0)\n#>  e1071               1.7-11  2022-06-07 [1] CRAN (R 4.2.1)\n#>  ellipsis            0.3.2   2021-04-29 [1] RSPM (R 4.2.0)\n#>  evaluate            0.15    2022-02-18 [1] RSPM (R 4.2.0)\n#>  extrafont           0.18    2022-04-12 [1] RSPM (R 4.2.0)\n#>  extrafontdb         1.0     2012-06-11 [1] RSPM (R 4.2.0)\n#>  fansi               1.0.3   2022-03-24 [1] RSPM (R 4.2.0)\n#>  farver              2.1.1   2022-07-06 [1] RSPM (R 4.2.0)\n#>  fastmap             1.1.0   2021-01-25 [1] RSPM (R 4.2.0)\n#>  forcats           * 0.5.1   2021-01-27 [1] RSPM (R 4.2.0)\n#>  fs                  1.5.2   2021-12-08 [1] RSPM (R 4.2.0)\n#>  gargle              1.2.0   2021-07-02 [1] RSPM (R 4.2.0)\n#>  generics            0.1.3   2022-07-05 [1] RSPM (R 4.2.0)\n#>  ggplot2           * 3.3.6   2022-05-03 [1] RSPM (R 4.2.0)\n#>  ggpmthemes        * 0.0.2   2022-07-29 [1] Github (pmassicotte/ggpmthemes@993d61e)\n#>  glue                1.6.2   2022-02-24 [1] RSPM (R 4.2.0)\n#>  googledrive         2.0.0   2021-07-08 [1] RSPM (R 4.2.0)\n#>  googlesheets4       1.0.0   2021-07-21 [1] RSPM (R 4.2.0)\n#>  gtable              0.3.0   2019-03-25 [1] RSPM (R 4.2.0)\n#>  haven               2.5.0   2022-04-15 [1] RSPM (R 4.2.0)\n#>  hms                 1.1.1   2021-09-26 [1] RSPM (R 4.2.0)\n#>  htmltools           0.5.3   2022-07-18 [1] RSPM (R 4.2.0)\n#>  htmlwidgets         1.5.4   2021-09-08 [1] RSPM (R 4.2.0)\n#>  httpuv              1.6.5   2022-01-05 [1] RSPM (R 4.2.0)\n#>  httr                1.4.3   2022-05-04 [1] RSPM (R 4.2.0)\n#>  jsonlite            1.8.0   2022-02-22 [1] RSPM (R 4.2.0)\n#>  KernSmooth          2.23-20 2021-05-03 [2] CRAN (R 4.2.1)\n#>  knitr               1.39    2022-04-26 [1] RSPM (R 4.2.0)\n#>  later               1.3.0   2021-08-18 [1] CRAN (R 4.2.1)\n#>  lattice             0.20-45 2021-09-22 [2] CRAN (R 4.2.1)\n#>  leafem              0.2.0   2022-04-16 [1] RSPM (R 4.2.0)\n#>  leaflet             2.1.1   2022-03-23 [1] RSPM (R 4.2.0)\n#>  lifecycle           1.0.1   2021-09-24 [1] RSPM (R 4.2.0)\n#>  lubridate           1.8.0   2021-10-07 [1] RSPM (R 4.2.0)\n#>  magrittr            2.0.3   2022-03-30 [1] RSPM (R 4.2.0)\n#>  mapview             2.11.0  2022-04-16 [1] RSPM (R 4.2.0)\n#>  memoise             2.0.1   2021-11-26 [1] RSPM (R 4.2.0)\n#>  mime                0.12    2021-09-28 [1] RSPM (R 4.2.0)\n#>  miniUI              0.1.1.1 2018-05-18 [1] RSPM (R 4.2.0)\n#>  modelr              0.1.8   2020-05-19 [1] RSPM (R 4.2.0)\n#>  munsell             0.5.0   2018-06-12 [1] RSPM (R 4.2.0)\n#>  patchwork         * 1.1.1   2020-12-17 [1] RSPM (R 4.2.0)\n#>  pillar              1.8.0   2022-07-18 [1] RSPM (R 4.2.0)\n#>  pkgbuild            1.3.1   2021-12-20 [1] RSPM (R 4.2.0)\n#>  pkgconfig           2.0.3   2019-09-22 [1] RSPM (R 4.2.0)\n#>  pkgload             1.3.0   2022-06-27 [1] RSPM (R 4.2.0)\n#>  png                 0.1-7   2013-12-03 [1] RSPM (R 4.2.0)\n#>  prettyunits         1.1.1   2020-01-24 [1] RSPM (R 4.2.0)\n#>  processx            3.7.0   2022-07-07 [1] RSPM (R 4.2.0)\n#>  profvis             0.3.7   2020-11-02 [1] RSPM (R 4.2.0)\n#>  promises            1.2.0.1 2021-02-11 [1] RSPM (R 4.2.0)\n#>  proxy               0.4-27  2022-06-09 [1] CRAN (R 4.2.1)\n#>  ps                  1.7.1   2022-06-18 [1] RSPM (R 4.2.0)\n#>  purrr             * 0.3.4   2020-04-17 [1] RSPM (R 4.2.0)\n#>  R6                  2.5.1   2021-08-19 [1] RSPM (R 4.2.0)\n#>  raster              3.5-21  2022-06-27 [1] RSPM (R 4.2.0)\n#>  Rcpp                1.0.9   2022-07-08 [1] RSPM (R 4.2.0)\n#>  readr             * 2.1.2   2022-01-30 [1] RSPM (R 4.2.0)\n#>  readxl              1.4.0   2022-03-28 [1] RSPM (R 4.2.0)\n#>  remotes             2.4.2   2021-11-30 [1] CRAN (R 4.2.1)\n#>  reprex              2.0.1   2021-08-05 [1] RSPM (R 4.2.0)\n#>  rlang               1.0.4   2022-07-12 [1] RSPM (R 4.2.0)\n#>  rmarkdown           2.14    2022-04-25 [1] RSPM (R 4.2.0)\n#>  rnaturalearth     * 0.1.0   2017-03-21 [1] RSPM (R 4.2.0)\n#>  rnaturalearthdata   0.1.0   2017-02-21 [1] RSPM (R 4.2.0)\n#>  rspm                0.1.0.3 2022-07-27 [1] Github (Enchufa2/rspm@ba091ae)\n#>  rstudioapi          0.13    2020-11-12 [1] RSPM (R 4.2.0)\n#>  Rttf2pt1            1.3.10  2022-02-07 [1] RSPM (R 4.2.0)\n#>  rvest               1.0.2   2021-10-16 [1] RSPM (R 4.2.0)\n#>  s2                  1.1.0   2022-07-18 [1] CRAN (R 4.2.1)\n#>  satellite           1.0.4   2021-10-12 [1] RSPM (R 4.2.0)\n#>  scales              1.2.0   2022-04-13 [1] RSPM (R 4.2.0)\n#>  sessioninfo         1.2.2   2021-12-06 [1] RSPM (R 4.2.0)\n#>  sf                * 1.0-8   2022-07-14 [1] RSPM (R 4.2.0)\n#>  shiny               1.7.2   2022-07-19 [1] RSPM (R 4.2.0)\n#>  sp                  1.5-0   2022-06-05 [1] RSPM (R 4.2.0)\n#>  stringi             1.7.8   2022-07-11 [1] RSPM (R 4.2.0)\n#>  stringr           * 1.4.0   2019-02-10 [1] RSPM (R 4.2.0)\n#>  terra               1.6-3   2022-07-25 [1] RSPM (R 4.2.0)\n#>  tibble            * 3.1.8   2022-07-22 [1] RSPM (R 4.2.0)\n#>  tidyr             * 1.2.0   2022-02-01 [1] RSPM (R 4.2.0)\n#>  tidyselect          1.1.2   2022-02-21 [1] RSPM (R 4.2.0)\n#>  tidyverse         * 1.3.2   2022-07-18 [1] RSPM (R 4.2.0)\n#>  tzdb                0.3.0   2022-03-28 [1] RSPM (R 4.2.0)\n#>  units               0.8-0   2022-02-05 [1] RSPM (R 4.2.0)\n#>  urlchecker          1.0.1   2021-11-30 [1] RSPM (R 4.2.0)\n#>  usethis             2.1.6   2022-05-25 [1] CRAN (R 4.2.1)\n#>  utf8                1.2.2   2021-07-24 [1] RSPM (R 4.2.0)\n#>  vctrs               0.4.1   2022-04-13 [1] RSPM (R 4.2.0)\n#>  webshot             0.5.3   2022-04-14 [1] CRAN (R 4.2.1)\n#>  withr               2.5.0   2022-03-03 [1] RSPM (R 4.2.0)\n#>  wk                  0.6.0   2022-01-03 [1] CRAN (R 4.2.1)\n#>  xfun                0.31    2022-05-10 [1] RSPM (R 4.2.0)\n#>  xml2                1.3.3   2021-11-30 [1] RSPM (R 4.2.0)\n#>  xtable              1.8-4   2019-04-21 [1] CRAN (R 4.2.1)\n#>  yaml                2.3.5   2022-02-21 [1] RSPM (R 4.2.0)\n#> \n#>  [1] /home/filoche/R/x86_64-pc-linux-gnu-library/4.2\n#>  [2] /opt/R/4.2.1/lib/R/library\n#> \n#> ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────\n```\n:::\n\n\n</details>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}