{
  "hash": "4b5732009619d4b235890b4c568fab88",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Choosing the right geographic projection with the crsuggest R package'\nauthor: 'Philippe Massicotte'\ndate: '2021-11-12'\ncategories: [R, Geospatial]\nimage: 'img/preview.png'\n---\n\n\n\n\n\n\nWhen creating maps, choosing an appropriate geographical projection is often a difficult task (at least for me). [There are plenty of projections to choose from](https://www.geo-projections.com/), and [none can be qualified as the best one](https://www.axismaps.com/guide/map-projections). It all depends on what you are trying to achieve. Websites like [the projection wizard website](https://projectionwizard.org/) offer a playground to experiment with different projections and how they look like depending on where you are looking at on the globe.\n\n![A medieval depiction of the Ecumene (1482, Johannes Schnitzer, engraver), constructed after the coordinates in Ptolemy's Geography and using his second map projection](img/preview.png)\n\n<small>Image from: https://en.wikipedia.org/wiki/Map_projection</small>\n\nThe goal of this blog post is not to go into details and consideration on how to choose _a good_ projection (it is out of my expertise), but rather present a quick overview of the `crsuggest` [R package](https://github.com/walkerke/crsuggest) that can help to find a projection suited for the data to be displayed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(sf)\nlibrary(patchwork)\nlibrary(crsuggest)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Download the Greenland shapefile\nmap <- ne_countries(country = \"greenland\", returnclass = \"sf\", scale = \"medium\")\n\n# Looks at the projection\nst_crs(map)$proj4string\n#> [1] \"+proj=longlat +datum=WGS84 +no_defs\"\n```\n:::\n\n\nWe can see that WGS84 is used as the reference coordinate system. Plotting the shapefile immediately shows that the result is somewhat distorted.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot() +\n  geom_sf(data = map)\n\np1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png)\n:::\n:::\n\n\nTime to look at the `crsuggest` package. The function `suggest_crs()` takes a spatial dataset as inputs (here the `map` object) and return a list (_n = 10_ by default) of suggested coordinate systems in a [tibble](https://tibble.tidyverse.org/).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuggested_crs <- suggest_crs(map, limit = 3)\nsuggested_crs\n#> # A tibble: 3 × 6\n#>   crs_code crs_name                         crs_type crs_gcs crs_units crs_proj4\n#>   <chr>    <chr>                            <chr>      <dbl> <chr>     <chr>    \n#> 1 5922     WGS 84 / EPSG Arctic Regional z… project…    4326 m         +proj=lc…\n#> 2 6054     GR96 / EPSG Arctic zone 3-31     project…    4747 m         +proj=lc…\n#> 3 6051     GR96 / EPSG Arctic zone 2-18     project…    4747 m         +proj=lc…\n```\n:::\n\n\nLet's make some plots using the suggested CRS.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_map <- function(crs, map) {\n  ggplot() +\n    geom_sf(data = map) +\n    coord_sf(crs = as.numeric(crs)) +\n    labs(\n      title = paste(\"CRS:\", crs)\n    )\n}\n\nmaps <- lapply(suggested_crs$crs_code, plot_map, map = map)\n```\n:::\n\n\nWe can see that the projected maps look more accurate than the original map.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrap_plots(maps, ncol = 3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png)\n:::\n:::\n\n\nThis is even more obvious when they are compared side by side.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot() +\n  geom_sf(data = map) +\n  coord_sf(crs = 5922)\n\np1 + p2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/compare_crs-1.png)\n:::\n:::\n\n\n<details>\n  \n<summary>Session info</summary>\n\n\n::: {.cell}\n\n```\n#> ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────\n#>  setting  value\n#>  version  R version 4.4.0 (2024-04-24)\n#>  os       Linux Mint 21.3\n#>  system   x86_64, linux-gnu\n#>  ui       X11\n#>  language en_CA:en\n#>  collate  en_CA.UTF-8\n#>  ctype    en_CA.UTF-8\n#>  tz       America/Montreal\n#>  date     2024-05-02\n#>  pandoc   2.9.2.1 @ /usr/bin/ (via rmarkdown)\n#> \n#> ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────\n#>  ! package           * version    date (UTC) lib source\n#>  P base64enc           0.1-3      2015-07-28 [?] RSPM\n#>  P cachem              1.0.8      2023-05-01 [?] RSPM\n#>  P class               7.3-22     2023-05-03 [?] CRAN (R 4.3.1)\n#>  P classInt            0.4-10     2023-09-05 [?] RSPM\n#>  P cli                 3.6.2      2023-12-11 [?] RSPM\n#>  P codetools           0.2-19     2023-02-01 [?] CRAN (R 4.2.2)\n#>  P colorspace          2.1-0      2023-01-23 [?] RSPM\n#>  P crosstalk           1.2.1      2023-11-23 [?] RSPM\n#>  P crsuggest         * 0.4        2022-07-06 [?] RSPM\n#>  P DBI                 1.2.2      2024-02-16 [?] RSPM\n#>  P devtools            2.4.5      2022-10-11 [?] RSPM (R 4.4.0)\n#>  P digest              0.6.35     2024-03-11 [?] RSPM\n#>  P dplyr             * 1.1.4      2023-11-17 [?] RSPM\n#>  P e1071               1.7-14     2023-12-06 [?] RSPM\n#>  P ellipsis            0.3.2      2021-04-29 [?] RSPM\n#>  P evaluate            0.23       2023-11-01 [?] RSPM\n#>  P extrafont           0.19       2023-01-18 [?] RSPM\n#>  P extrafontdb         1.0        2012-06-11 [?] RSPM\n#>  P fansi               1.0.6      2023-12-08 [?] RSPM\n#>  P farver              2.1.1      2022-07-06 [?] RSPM\n#>  P fastmap             1.1.1      2023-02-24 [?] RSPM\n#>  P forcats           * 1.0.0      2023-01-29 [?] RSPM\n#>  P fs                  1.6.4      2024-04-25 [?] CRAN (R 4.4.0)\n#>  P generics            0.1.3      2022-07-05 [?] RSPM\n#>  P ggplot2           * 3.5.1      2024-04-23 [?] RSPM\n#>  P ggpmthemes        * 0.0.2      2024-04-25 [?] Github (pmassicotte/ggpmthemes@993d61e)\n#>  P glue                1.7.0      2024-01-09 [?] RSPM\n#>  P gtable              0.3.5      2024-04-22 [?] RSPM\n#>  P hms                 1.1.3      2023-03-21 [?] RSPM\n#>  P htmltools           0.5.8.1    2024-04-04 [?] RSPM\n#>  P htmlwidgets         1.6.4      2023-12-06 [?] RSPM\n#>  P httpuv              1.6.15     2024-03-26 [?] RSPM\n#>  P httr                1.4.7      2023-08-15 [?] RSPM\n#>  P jsonlite            1.8.8      2023-12-04 [?] RSPM\n#>  P KernSmooth          2.23-22    2023-07-10 [?] CRAN (R 4.3.1)\n#>  P knitr               1.46       2024-04-06 [?] RSPM\n#>  P later               1.3.2      2023-12-06 [?] RSPM\n#>  P lattice             0.22-6     2024-03-20 [?] RSPM (R 4.4.0)\n#>  P leafem              0.2.3      2023-09-17 [?] RSPM\n#>  P leaflet             2.2.2      2024-03-26 [?] RSPM\n#>  P lifecycle           1.0.4      2023-11-07 [?] RSPM\n#>  P lubridate         * 1.9.3      2023-09-27 [?] RSPM\n#>  P magrittr            2.0.3      2022-03-30 [?] RSPM\n#>  P mapview             2.11.2     2023-10-13 [?] RSPM\n#>  P memoise             2.0.1      2021-11-26 [?] RSPM\n#>  P mime                0.12       2021-09-28 [?] RSPM\n#>  P miniUI              0.1.1.1    2018-05-18 [?] RSPM (R 4.4.0)\n#>  P munsell             0.5.1      2024-04-01 [?] RSPM\n#>  P patchwork         * 1.2.0      2024-01-08 [?] RSPM\n#>  P pillar              1.9.0      2023-03-22 [?] RSPM\n#>  P pkgbuild            1.4.4      2024-03-17 [?] RSPM (R 4.4.0)\n#>  P pkgconfig           2.0.3      2019-09-22 [?] RSPM\n#>  P pkgload             1.3.4      2024-01-16 [?] RSPM (R 4.4.0)\n#>  P png                 0.1-8      2022-11-29 [?] RSPM\n#>  P processx            3.8.4      2024-03-16 [?] RSPM\n#>  P profvis             0.3.8      2023-05-02 [?] RSPM (R 4.4.0)\n#>  P promises            1.3.0      2024-04-05 [?] RSPM\n#>  P proxy               0.4-27     2022-06-09 [?] RSPM\n#>  P ps                  1.7.6      2024-01-18 [?] RSPM\n#>  P purrr             * 1.0.2      2023-08-10 [?] RSPM\n#>  P quarto            * 1.4        2024-03-06 [?] RSPM\n#>  P R.cache             0.16.0     2022-07-21 [?] RSPM\n#>  P R.methodsS3         1.8.2      2022-06-13 [?] RSPM\n#>  P R.oo                1.26.0     2024-01-24 [?] RSPM\n#>  P R.utils             2.12.3     2023-11-18 [?] RSPM\n#>  P R6                  2.5.1      2021-08-19 [?] RSPM\n#>  P raster              3.6-26     2023-10-14 [?] RSPM\n#>  P Rcpp                1.0.12     2024-01-09 [?] RSPM\n#>  P readr             * 2.1.5      2024-01-10 [?] RSPM\n#>  P remotes             2.5.0      2024-03-17 [?] RSPM (R 4.4.0)\n#>  P renv                1.0.7      2024-04-11 [?] RSPM (R 4.4.0)\n#>  P rlang               1.1.3      2024-01-10 [?] RSPM\n#>  P rmarkdown           2.26       2024-03-05 [?] RSPM\n#>  P rnaturalearth     * 1.0.1      2023-12-15 [?] RSPM\n#>  P rnaturalearthdata * 1.0.0.9000 2024-05-02 [?] Github (ropensci/rnaturalearthdata@d0e161e)\n#>  P rstudioapi          0.16.0     2024-03-24 [?] RSPM\n#>  P Rttf2pt1            1.3.12     2023-01-22 [?] RSPM\n#>  P satellite           1.0.5      2024-02-10 [?] RSPM\n#>  P scales              1.3.0      2023-11-28 [?] RSPM\n#>  P sessioninfo         1.2.2      2021-12-06 [?] RSPM (R 4.4.0)\n#>  P sf                * 1.0-16     2024-03-24 [?] RSPM\n#>  P shiny               1.8.1.1    2024-04-02 [?] RSPM (R 4.4.0)\n#>  P sp                  2.1-4      2024-04-30 [?] CRAN (R 4.4.0)\n#>  P stringi             1.8.3      2023-12-11 [?] RSPM\n#>  P stringr           * 1.5.1      2023-11-14 [?] RSPM\n#>  P styler            * 1.10.3     2024-04-07 [?] RSPM\n#>  P terra               1.7-71     2024-01-31 [?] RSPM\n#>  P tibble            * 3.2.1      2023-03-20 [?] RSPM\n#>  P tidyr             * 1.3.1      2024-01-24 [?] RSPM\n#>  P tidyselect          1.2.1      2024-03-11 [?] RSPM\n#>  P tidyverse         * 2.0.0      2023-02-22 [?] RSPM\n#>  P timechange          0.3.0      2024-01-18 [?] RSPM\n#>  P tzdb                0.4.0      2023-05-12 [?] RSPM\n#>  P units               0.8-5      2023-11-28 [?] RSPM\n#>  P urlchecker          1.0.1      2021-11-30 [?] RSPM (R 4.4.0)\n#>  P usethis             2.2.3      2024-02-19 [?] RSPM (R 4.4.0)\n#>  P utf8                1.2.4      2023-10-22 [?] RSPM\n#>  P vctrs               0.6.5      2023-12-01 [?] RSPM\n#>  P withr               3.0.0      2024-01-16 [?] RSPM\n#>  P xfun                0.43       2024-03-25 [?] RSPM\n#>  P xtable              1.8-4      2019-04-21 [?] RSPM (R 4.4.0)\n#>  P yaml                2.3.8      2023-12-11 [?] RSPM\n#> \n#>  [1] /tmp/RtmpP1MQP8/renv-use-libpath-18807a3f89bb01\n#>  [2] /tmp/RtmpP1MQP8/renv-sandbox\n#> \n#>  P ── Loaded and on-disk path mismatch.\n#> \n#> ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────\n```\n:::\n\n\n</details>\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}