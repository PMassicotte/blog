---
title: "Publications"
comments: false
execute: 
  freeze: false
---

```{r}
#| echo: false
#| warning: false
#| message: false
#| eval: true
library(tidyverse)
library(httr2)
library(gt)
library(glue)

key <- Sys.getenv("ZOTERO_KEY")

res2 <- request("https://api.zotero.org/users/5837870/publications/items/") |>
  req_headers(
    "Zotero-API-Version" = "3",
    "Zotero-API-Key" = key,
    "Accept" = "application/json"
  ) |>
  req_url_query(limit = 100, sort = "date", direction = "desc") |>
  req_perform() |>
  resp_body_json(simplifyVector = TRUE) |>
  as_tibble()

res2$data |>
  as_tibble() |>
  mutate(authors = map_chr(creators, ~ toString(paste(.$firstName, .$lastName)))) |>
  filter(authors != "") |>
  mutate(year = str_match(date, "\\d{4}")) |>
  mutate(u = glue("**{title}**<br>{authors}, *{publicationTitle}*, ({year}), <https://doi.org/{DOI}>")) |>
  select(u) |>
  gt() |>
  fmt_markdown(everything()) |>
  cols_align(align = "left") |>
  tab_options(
    data_row.padding = px(20),
    column_labels.hidden = TRUE
  )
```
